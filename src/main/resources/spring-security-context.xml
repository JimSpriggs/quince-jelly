<beans xmlns="http://www.springframework.org/schema/beans"	xmlns:security="http://www.springframework.org/schema/security"	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"	xsi:schemaLocation="http://www.springframework.org/schema/beanshttp://www.springframework.org/schema/beans/spring-beans-4.3.xsdhttp://www.springframework.org/schema/securityhttp://www.springframework.org/schema/security/spring-security-4.1.xsd">		<security:http auto-config="false" entry-point-ref="loginUrlAuthenticationEntryPoint" disable-url-rewriting="true" use-expressions="true">	    <security:custom-filter position="FORM_LOGIN_FILTER" ref="usernamePasswordAuthenticationFilter" />		<security:logout logout-success-url="/signin" />		<security:remember-me services-ref="rememberMeServices" key="remember-me-key"/>		<security:intercept-url pattern="/" access="permitAll" />		<security:intercept-url pattern="/logout" access="permitAll" />        <security:intercept-url pattern="/favicon.ico" access="permitAll" />        <security:intercept-url pattern="/resources/**" access="permitAll" />		<security:intercept-url pattern="/signin" access="permitAll" />		<security:intercept-url pattern="/signup" access="permitAll" />		<security:intercept-url pattern="/activate" access="permitAll" />		<security:intercept-url pattern="/forgottenPassword" access="permitAll" />		<security:intercept-url pattern="/resetPassword" access="permitAll" />		<security:intercept-url pattern="/accessDenied/**" access="permitAll" />		<security:intercept-url pattern="/email/u/*" access="permitAll" />		<security:intercept-url pattern="/email/c/*" access="permitAll" />		<security:intercept-url pattern="/admin/dashboard" access="isAuthenticated()" />		<security:intercept-url pattern="/admin/email*" access="hasRole('ROLE_ADMIN') or hasRole('ROLE_EMAIL_ADMIN')" />		<security:intercept-url pattern="/admin/addEmail" access="hasRole('ROLE_ADMIN') or hasRole('ROLE_EMAIL_ADMIN')" />		<security:intercept-url pattern="/admin/editEmail" access="hasRole('ROLE_ADMIN') or hasRole('ROLE_EMAIL_ADMIN')" />		<security:intercept-url pattern="/admin/sendEmail" access="hasRole('ROLE_ADMIN') or hasRole('ROLE_EMAIL_ADMIN')" />		<security:intercept-url pattern="/admin/document*" access="hasRole('ROLE_ADMIN') or hasRole('ROLE_EMAIL_ADMIN')" />		<security:intercept-url pattern="/admin/addDocument" access="hasRole('ROLE_ADMIN') or hasRole('ROLE_EMAIL_ADMIN')" />		<security:intercept-url pattern="/admin/deleteDocument" access="hasRole('ROLE_ADMIN') or hasRole('ROLE_EMAIL_ADMIN')" />		<security:intercept-url pattern="/admin/**" access="hasRole('ROLE_ADMIN')" />		<security:intercept-url pattern="/**" access="isAuthenticated()" />	</security:http>	<security:authentication-manager alias="authenticationManager" erase-credentials="true" >		<security:authentication-provider user-service-ref="userService">			<security:password-encoder ref="passwordEncoder" />		</security:authentication-provider>	</security:authentication-manager>	<bean id="loginUrlAuthenticationEntryPoint" class="org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint"> 		<constructor-arg value="/signin"/>	</bean>		<bean id="authenticationFailureHandler"	    class="org.springframework.security.web.authentication.ExceptionMappingAuthenticationFailureHandler">	    <property name="exceptionMappings">	        <props>	            <prop	                key="org.springframework.security.authentication.BadCredentialsException">	                /accessDenied/credentials	            </prop>	            <prop 	            	key="org.springframework.security.authentication.LockedException">	                /accessDenied/activate	            </prop>	            <prop	            	key="org.springframework.security.authentication.AuthenticationServiceException">	            	/accessDenied/error	            </prop>	        </props>	    </property>	</bean>	<bean id="successHandler" class="uk.co.village_greens_coop.VillageGreensMemberPortal.support.web.VGAuthenticationSuccessHandler"> 		<property name="defaultTargetUrl" value="/admin/dashboard"/>	</bean>	<bean id="usernamePasswordAuthenticationFilter"	    class="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter"> 		<property name="authenticationManager" ref="authenticationManager" />	    <property name="authenticationFailureHandler" ref="authenticationFailureHandler" /> 	    <property name="authenticationSuccessHandler" ref="successHandler" />	</bean>	</beans>